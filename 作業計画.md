### **作業計画**

#### **1. 現状分析と要件定義**

*   **目的:** 既存のアンケートファイルの構造を理解し、最終的なアウトプットの仕様を固める。
*   **タスク:**
    1.  `data` ディレクトリ内のExcelファイル（例: `2025年7月1日インターネット調査.xlsx`）を開き、以下のシートの構成を確認する。
        *   `質問対応表` シート: 質問番号と質問文の対応関係を把握する。
        *   `data` シート: 回答データと列（質問番号）の形式を確認する。
    2.  クライアントごとに集計が必要な質問を定義する「クライアント別集計設定シート」のフォーマットを決定する。以下に例を示す。

| クライアント名 | 集計対象の質問文 |
| :--- | :--- |
| A社 | あなたの年代を教えてください。 |
| A社 | あなたの性別を教えてください。 |
| B社 | 〇〇というサービスを知っていますか？ |

#### **2. 処理スクリプトの作成 (Python + pandas)**

*   **目的:** 一連のデータ処理を自動化し、効率的に集計結果を得る。
*   **タスク:**
    1.  **質問マスターの作成:**
        *   `data` ディレクトリ内の全Excelファイルを走査する。
        *   各ファイルの `質問対応表` シートから「質問番号」と「質問文」を抽出する。
        *   ファイル名、質問番号、質問文を紐づけた「質問マスター対応表」を作成し、CSVまたはExcelファイルとして出力する。
    2.  **データ統合:**
        *   各ファイルの `data` シートを読み込む。
        *   列名を、作成した「質問マスター対応表」を元に、質問番号から実際の「質問文」に置換する。
        *   全ファイルのデータを縦に結合し、一つの大きなデータフレームを作成する。
    3.  **クライアント別集計:**
        *   「クライアント別集計設定シート」を読み込む。
        *   設定シートに基づき、クライアントごとに必要な列（質問文）を統合データから抽出する。
        *   抽出したデータを用いて、単純集計やクロス集計などの統計処理を実行する。
    4.  **結果出力:**
        *   集計結果をクライアントごとにシートを分けて、一つのExcelファイルに出力する。
        *   ファイル名は `result/集計結果_{日付}.xlsx` のような形式とする。
